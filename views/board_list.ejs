<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="../../stylesheets/index.css">
    <link rel="stylesheet" href="../../stylesheets/fontello.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <header>
    <div id="header_up">
        <a class="h_ups" id="home_icon" href="/">&#xe800</a>
        <h1 class="h_ups" id="main_title"><a href="/" style="color: cornflowerblue;">D2VTS</a></h1>
        <% if(sess.idx){ %>
          <div class="h_ups" id=login_div>
            <a href="/mypage" class="loginbtns" id="mypage_btn">&nbsp;마이페이지&nbsp;</a>
            <a href="/logout" class="loginbtns" id="logout_btn">&nbsp;로그아웃&nbsp;</a>
          </div>
          <% } else{ %>
        <div class="h_ups" id=login_div>
          <a href="/sign_up" class="loginbtns" id="sign_up_btn">&nbsp;회원가입&nbsp;</a>
          <a href="/login" class="loginbtns" id="login_btn">&nbsp;로그인&nbsp;</a>
        </div>
        <% } %>
      </div>
    </header>
    <h1> 게시판 </h1>
    <table>
        <tr>
            <th>제목</td>
            <th>작성자</td>
            <th>조회수</td>
            <th>작성일</td>
        </tr>
        <% for(var i = 0; i< listCnt; i++){%>
            <% if( post[i] != undefined){ %>
            <tr>
                <td><a href="/board/detail/<%=post[i].id%>"><%= post[i].title %></a></td>
                <!-- 아래의 작성자에 user테이블을 이용해서 user.id에 해당하는 user.nickname을 넣어줘야함 -->
                <% for(let user of users){ %>
                <% if(post[i].user_id==user.id){ %>
                <td><%= user.nickname %></td>
                <td><%= post[i].views %></td>
                <td><%= post[i].createdAt.toLocaleString() %></td>
                <%}}%>
            </tr>
            <%} else {%>
            <%}%>
            <%} %>

                <!-- //////////////////kind = reqquery//////////////// -->
                <tr class="main-table" id="page">
                    <td class="align" id="page_td" colspan="14">
                    
                        <% if(reqquery){%>
                            <% if(pageNow > 1){ %>
                                <% if(startPage==1) {%>
                                    [<a href="/board/list/1?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>">◀◀</a>]
                                    <%} else {%>
                                [<a href="/board/list/<%=startPage-1%>?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>">◀◀</a>]
                                <%}%>
                                [<a href="/board/list/<%= pageNow - 1 %>?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>">◀</a>]
                            <% } else{ %>
                                <button onclick="alert('첫 페이지 입니다.')"><a href="/board/list/1?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>">■</a></button>
                                <% } %>
    
                                <% for(var i = startPage  ; i <= endPage ; i++ ){ %>
                                <% if(i==pageNow){ %>
                                    [ <span style="font-weight: bold;"><%= i %></span> ]
                                    <% } else { %>
                                        [<a href="/board/list/<%=i%>?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>"><%=i%></a>]
                                        <% }} %>
    
                                <% if(pageNow < totalPage){ %>
                                    [<a href="/board/list/<%= pageNow + 1 %>?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>">▶</a>]
    
                                    <% if(endPage+1>totalPage){ %>
                                        [<a href="/board/list/<%= endPage  %>?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>">▶▶</a>]
                                        <% }else { %>
                                    [<a href="/board/list/<%= endPage +1 %>?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>">▶▶</a>]
                                    <% } %>
                                <% } else { %>
                                    <button onclick="alert('마지막 페이지 입니다.')"><a href="/board/list/<%=totalPage%>?find_type=<%=reqquery.find_type%>&_query=<%=reqquery._query%>">■</a></button>
                                    <% } %>

                        <%} else{ %>
                        <% if(pageNow > 1){ %>
                            <% if(startPage==1) {%>
                                [<a href="/board/list/1">◀◀</a>]
                                <%} else {%>
                            [<a href="/board/list/<%=startPage-1%>">◀◀</a>]
                            <%}%>
                            [<a href="/board/list/<%= pageNow - 1 %>">◀</a>]
                        <% } else{ %>
                            <button onclick="alert('첫 페이지 입니다.')"><a href="/board/list/1">■</a></button>
                            <% } %>

                            <% for(var i = startPage  ; i <= endPage ; i++ ){ %>
                            <% if(i==pageNow){ %>
                                [ <span style="font-weight: bold;"><%= i %></span> ]
                                <% } else { %>
                                    [<a href="/board/list/<%=i%>"><%=i%></a>]
                                    <% }} %>

                            <% if(pageNow < totalPage){ %>
                                [<a href="/board/list/<%= pageNow + 1 %>">▶</a>]

                                <% if(endPage+1>totalPage){ %>
                                    [<a href="/board/list/<%= endPage  %>">▶▶</a>]
                                    <% }else { %>
                                [<a href="/board/list/<%= endPage +1 %>">▶▶</a>]
                                <% } %>
                            <% } else { %>
                                <button onclick="alert('마지막 페이지 입니다.')"><a href="/board/list/<%=totalPage%>">■</a></button>
                                <% }} %>

                    </td>
                </tr>
                <!-- /////////////////////////////////// -->

    </table>
    <% if(sess!=undefined){ %>
    <span ><a href="/board/create">글 작성하기</a></span>
    <%}else{%>
    <span ><a href="/login/towrp">글 작성하기</a></span>
    <% }%>


    <form action="/board/list/<%=pageNow%>">

        <select name="find_type">
            <option value="title">제목</option>
            <option value="content">내용</option>
            <option value="contentitle">제목+내용</option>
            <option value="writer">작성자</option>
        </select><input name="_query" placeholder="검색어 입력" type="text"><input type="submit" value="검색">

    </form>





</body>
</html>